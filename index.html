<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçπ Tiki Bar - Cocktail Recipe Database</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            opacity: 0.7;
        }

        .tab-btn.active {
            background: #4ECDC4;
            color: white;
            opacity: 1;
        }

        .tab-btn:hover {
            opacity: 1;
            transform: translateY(-2px);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .search-bar {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .search-controls {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            margin-bottom: 15px;
        }

        input[type="text"], textarea, select {
            padding: 12px 20px;
            font-size: 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            width: 100%;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        input[type="text"]:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 12px 24px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #4ECDC4;
            color: white;
        }

        .btn-secondary:hover {
            background: #45b8b0;
            transform: translateY(-2px);
        }

        .btn-accent {
            background: #FF6B6B;
            color: white;
        }

        .btn-accent:hover {
            background: #ee5a52;
            transform: translateY(-2px);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 14px;
        }

        .filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
        }

        .filter-btn:hover {
            background: #e0e0e0;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #5568d3;
        }

        .results-info {
            background: white;
            padding: 15px 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .drinks-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
        }

        .drink-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
        }

        .drink-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }

        .favorite-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            transition: transform 0.3s;
            padding: 5px;
        }

        .favorite-btn:hover {
            transform: scale(1.2);
        }

        .favorite-btn.favorited {
            color: #ff6b6b;
        }

        .drink-header {
            margin-bottom: 15px;
            padding-right: 40px;
        }

        .drink-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 8px;
        }

        .drink-category {
            display: inline-block;
            background: #4ECDC4;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .ingredients-list {
            list-style: none;
            margin-top: 15px;
        }

        .ingredients-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
            color: #555;
            font-size: 0.95em;
        }

        .ingredients-list li:last-child {
            border-bottom: none;
        }

        .ingredients-list li::before {
            content: "üçπ ";
            margin-right: 8px;
        }

        .no-results {
            text-align: center;
            padding: 60px 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            grid-column: 1 / -1;
        }

        .no-results h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 2em;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .section h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .ingredient-input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .inventory-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .match-percentage {
            display: inline-block;
            background: #4ECDC4;
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 10px;
        }

        .match-percentage.perfect {
            background: #51cf66;
        }

        .match-percentage.partial {
            background: #ffa94d;
        }

        .export-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            .search-controls {
                grid-template-columns: 1fr;
            }

            .drinks-grid {
                grid-template-columns: 1fr;
            }

            .results-info {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üçπ Tiki Bar</h1>
            <p>Your Ultimate Cocktail Recipe Database</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('browse')">üîç Browse Drinks</button>
            <button class="tab-btn" onclick="switchTab('favorites')">‚ù§Ô∏è Favorites</button>
            <button class="tab-btn" onclick="switchTab('inventory')">üì¶ My Bar Inventory</button>
            <button class="tab-btn" onclick="switchTab('custom')">‚ûï Add Custom Drink</button>
            <button class="tab-btn" onclick="switchTab('data')">üíæ Manage Data</button>
        </div>

        <!-- Browse Tab -->
        <div id="browseTab" class="tab-content active">
            <div class="search-bar">
                <div class="search-controls">
                    <input type="text" id="searchInput" placeholder="Search drinks by name or ingredient...">
                    <div class="btn-group">
                        <button class="btn-primary" onclick="searchDrinks()">Search</button>
                        <button class="btn-secondary" onclick="getRandomDrink()">Random</button>
                        <button class="btn-accent" onclick="showAllDrinks()">Show All</button>
                    </div>
                </div>
                
                <div class="filters" id="categoryFilters"></div>
            </div>

            <div class="section">
                <h2>üßë‚Äçüç≥ Personal Bartender</h2>
                <p style="margin-bottom: 15px; color: #666;">Enter ingredients you have or use your saved inventory:</p>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <input type="text" id="ingredientsInput" placeholder="e.g., rum, lime juice, simple syrup" style="flex: 1; min-width: 250px;">
                    <button class="btn-primary" onclick="findDrinksByIngredients()">Find Drinks</button>
                    <button class="btn-secondary" onclick="useInventory()">Use My Inventory</button>
                </div>
            </div>

            <div class="results-info" id="resultsInfo">
                <span id="resultCount">Showing all drinks</span>
                <span id="totalCount"></span>
            </div>

            <div class="drinks-grid" id="drinksGrid"></div>
        </div>

        <!-- Favorites Tab -->
        <div id="favoritesTab" class="tab-content">
            <div class="section">
                <h2>‚ù§Ô∏è Your Favorite Drinks</h2>
                <p style="color: #666; margin-bottom: 20px;">Click the heart icon on any drink to add it to your favorites</p>
            </div>
            <div class="drinks-grid" id="favoritesGrid"></div>
        </div>

        <!-- Inventory Tab -->
        <div id="inventoryTab" class="tab-content">
            <div class="section">
                <h2>üì¶ My Bar Inventory</h2>
                <p style="color: #666; margin-bottom: 15px;">Track what ingredients you have at home</p>
                
                <div class="ingredient-input-group">
                    <input type="text" id="newIngredient" placeholder="Add ingredient (e.g., Bacardi rum)">
                    <button class="btn-primary" onclick="addToInventory()">Add</button>
                </div>

                <div class="inventory-grid" id="inventoryGrid"></div>
            </div>
        </div>

        <!-- Custom Drinks Tab -->
        <div id="customTab" class="tab-content">
            <div class="section">
                <h2>‚ûï Add Custom Drink</h2>
                
                <div class="form-group">
                    <label>Drink Name *</label>
                    <input type="text" id="customName" placeholder="Enter drink name">
                </div>

                <div class="form-group">
                    <label>Category</label>
                    <select id="customCategory">
                        <option>Tiki Classics</option>
                        <option>Modern Tiki</option>
                        <option>Tiki Essentials</option>
                        <option>Bitters Classics</option>
                        <option>Custom</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Ingredients (one per line) *</label>
                    <textarea id="customIngredients" placeholder="e.g.,&#10;2 oz rum&#10;1 oz lime juice&#10;0.5 oz simple syrup"></textarea>
                </div>

                <button class="btn-primary" onclick="saveCustomDrink()">Save Drink</button>
            </div>

            <div class="section">
                <h2>üìù Your Custom Drinks</h2>
                <div class="drinks-grid" id="customDrinksGrid"></div>
            </div>
        </div>

        <!-- Data Management Tab -->
        <div id="dataTab" class="tab-content">
            <div class="section">
                <h2>üíæ Export & Import Data</h2>
                <p style="color: #666; margin-bottom: 20px;">Backup your favorites, inventory, and custom drinks</p>
                
                <div class="btn-group">
                    <button class="btn-primary" onclick="exportData()">Export All Data</button>
                    <button class="btn-secondary" onclick="document.getElementById('importFile').click()">Import Data</button>
                    <button class="btn-accent" onclick="clearAllData()">Clear All Data</button>
                </div>
                
                <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importData(event)">

                <div class="export-section">
                    <h3 style="color: #667eea; margin-bottom: 10px;">Data Summary</h3>
                    <p>Favorites: <strong id="favCount">0</strong></p>
                    <p>Inventory Items: <strong id="invCount">0</strong></p>
                    <p>Custom Drinks: <strong id="customCount">0</strong></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DRINK DATA - Add all your drinks from the Discord bot here
        const drinkRecipes = {
            'polynesian-pearl': {
                name: 'Polynesian Pearl',
                ingredients: ['0.5 oz cinnamon syrup (2 pumps)', '3 oz POG juice', '1 oz Grand Marnier', '1.5 oz RumChata'],
                category: 'Tiki Classics'
            },
            'classic-mai-tai': {
                name: 'Classic Mai Tai',
                ingredients: ['1 oz white rum', '1 oz dark rum', '1 oz lime juice', '0.75 oz orgeat syrup', '0.5 oz Grand Marnier', 'garnish with lime wheel and mint sprig'],
                category: 'Tiki Essentials'
            },
            'zombie-classic': {
                name: 'Zombie (Classic)',
                ingredients: ['1.5 oz Jamaican rum', '1.5 oz Puerto Rico rum', '1 oz 151 proof demerara rum', '0.75 oz lime juice', '0.5 oz grapefruit juice', '0.25 oz cinnamon syrup', '0.5 oz falernum', '1 tsp grenadine', '1 barspoon absinthe', '1 dash Angostura bitters'],
                category: 'Tiki Essentials'
            },
            'painkiller': {
                name: 'Painkiller',
                ingredients: ['2 oz dark rum', '4 oz pineapple juice', '1 oz orange juice', '1 oz cream of coconut', 'garnish with nutmeg and orange slice'],
                category: 'Tiki Essentials'
            },
            'pina-colada': {
                name: 'Pi√±a Colada',
                ingredients: ['1.5 oz white rum', '1 oz aged rum', '3 oz pineapple juice', '1.5 oz cream of coconut', '0.5 oz lime juice', 'blend with ice, garnish with pineapple'],
                category: 'Tiki Essentials'
            },
            'manhattan-enhanced': {
                name: 'Manhattan (Enhanced)',
                ingredients: ['2 oz rye or bourbon', '1 oz sweet vermouth', '1 dash Angostura bitters', '1 dash orange bitters', 'stir with ice until chilled', 'strain into chilled coupe', 'garnish with amarena cherry or lemon twist'],
                category: 'Bitters Classics'
            },
            'old-fashioned-enhanced': {
                name: 'Old Fashioned (Enhanced)',
                ingredients: ['2 oz bourbon or rye', '0.25 oz simple syrup', '3 dashes Angostura bitters', '1 dash orange bitters', 'stir with ice', 'strain over large cube', 'garnish with orange twist'],
                category: 'Bitters Classics'
            }
            // ADD MORE DRINKS FROM YOUR DOCUMENT HERE
        };

        const baseMixes = {
            'pog-juice': {
                name: 'POG Juice',
                description: 'A mixture of passion fruit, orange, and guava juices.'
            }
            // ADD MORE BASE MIXES HERE
        };

        // Database using localStorage
        const DB = {
            get: (key) => {
                try {
                    const data = localStorage.getItem(key);
                    return data ? JSON.parse(data) : null;
                } catch(e) {
                    console.error('Error reading from localStorage:', e);
                    return null;
                }
            },
            set: (key, value) => {
                try {
                    localStorage.setItem(key, JSON.stringify(value));
                } catch(e) {
                    console.error('Error writing to localStorage:', e);
                }
            },
            remove: (key) => {
                try {
                    localStorage.removeItem(key);
                } catch(e) {
                    console.error('Error removing from localStorage:', e);
                }
            }
        };

        // Initialize data structures
        let favorites = DB.get('favorites') || [];
        let inventory = DB.get('inventory') || [];
        let customDrinks = DB.get('customDrinks') || {};
        let currentFilter = 'all';
        let displayedDrinks = Object.keys(drinkRecipes);

        function getAllDrinks() {
            return {...drinkRecipes, ...customDrinks};
        }

        function init() {
            createCategoryFilters();
            showAllDrinks();
            updateDataSummary();
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName + 'Tab').classList.add('active');

            if (tabName === 'favorites') displayFavorites();
            if (tabName === 'inventory') displayInventory();
            if (tabName === 'custom') displayCustomDrinks();
            if (tabName === 'data') updateDataSummary();
        }

        function createCategoryFilters() {
            const allDrinks = getAllDrinks();
            const categories = [...new Set(Object.values(allDrinks).map(d => d.category))];
            const filtersDiv = document.getElementById('categoryFilters');
            
            filtersDiv.innerHTML = `
                <button class="filter-btn active" onclick="filterByCategory('all')">All</button>
                ${categories.map(cat => 
                    `<button class="filter-btn" onclick="filterByCategory('${cat}')">${cat}</button>`
                ).join('')}
            `;
        }

        function filterByCategory(category) {
            currentFilter = category;
            const allDrinks = getAllDrinks();
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
                if ((category === 'all' && btn.textContent === 'All') || btn.textContent === category) {
                    btn.classList.add('active');
                }
            });
            
            if (category === 'all') {
                displayedDrinks = Object.keys(allDrinks);
            } else {
                displayedDrinks = Object.keys(allDrinks).filter(key => 
                    allDrinks[key].category === category
                );
            }
            
            displayDrinks(displayedDrinks);
        }

        function searchDrinks() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            const allDrinks = getAllDrinks();
            
            if (!searchTerm) {
                showAllDrinks();
                return;
            }

            const results = Object.keys(allDrinks).filter(key => {
                const drink = allDrinks[key];
                const nameMatch = drink.name.toLowerCase().includes(searchTerm);
                const ingredientMatch = drink.ingredients.some(ing => 
                    ing.toLowerCase().includes(searchTerm)
                );
                return nameMatch || ingredientMatch;
            });

            displayedDrinks = results;
            displayDrinks(results);
            
            document.getElementById('resultCount').textContent = 
                results.length > 0 
                    ? `Found ${results.length} drink${results.length !== 1 ? 's' : ''} matching "${searchTerm}"`
                    : `No drinks found matching "${searchTerm}"`;
        }

        function getRandomDrink() {
            const allDrinks = getAllDrinks();
            const keys = Object.keys(allDrinks);
            const randomKey = keys[Math.floor(Math.random() * keys.length)];
            displayedDrinks = [randomKey];
            displayDrinks([randomKey]);
            document.getElementById('resultCount').textContent = 'üé≤ Random Drink';
        }

        function showAllDrinks() {
            const allDrinks = getAllDrinks();
            displayedDrinks = Object.keys(allDrinks);
            displayDrinks(displayedDrinks);
            document.getElementById('resultCount').textContent = 'Showing all drinks';
            document.getElementById('searchInput').value = '';
        }

        function toggleFavorite(drinkKey) {
            const index = favorites.indexOf(drinkKey);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(drinkKey);
            }
            DB.set('favorites', favorites);
            
            const btn = event.target;
            btn.classList.toggle('favorited');
            btn.textContent = favorites.includes(drinkKey) ? '‚ù§Ô∏è' : 'ü§ç';
            updateDataSummary();
        }

        function findDrinksByIngredients() {
            const input = document.getElementById('ingredientsInput').value.toLowerCase().trim();
            
            if (!input) {
                alert('Please enter some ingredients!');
                return;
            }

            const userIngredients = input.split(',').map(ing => ing.trim());
            matchDrinks(userIngredients);
        }

        function useInventory() {
            if (inventory.length === 0) {
                alert('Your inventory is empty! Add ingredients in the Inventory tab.');
                return;
            }
            matchDrinks(inventory.map(i => i.toLowerCase()));
        }

        function matchDrinks(userIngredients) {
            const allDrinks = getAllDrinks();
            const matches = [];

            Object.keys(allDrinks).forEach(key => {
                const drink = allDrinks[key];
                let matchCount = 0;
                let totalIngredients = 0;

                drink.ingredients.forEach(ingredientLine => {
                    const lowerLine = ingredientLine.toLowerCase();
                    
                    if (lowerLine.startsWith('garnish') || lowerLine.startsWith('serve') || 
                        lowerLine.startsWith('blend') || lowerLine.startsWith('shake') || 
                        lowerLine.startsWith('stir') || lowerLine.startsWith('muddle') ||
                        lowerLine.startsWith('rim')) {
                        return;
                    }
                    
                    totalIngredients++;
                    
                    const hasIngredient = userIngredients.some(userIng => {
                        return lowerLine.includes(userIng) || 
                               userIng.split(' ').some(word => word.length > 3 && lowerLine.includes(word));
                    });
                    
                    if (hasIngredient) matchCount++;
                });

                if (totalIngredients > 0) {
                    const percentage = Math.round((matchCount / totalIngredients) * 100);
                    if (percentage >= 50) {
                        matches.push({
                            key,
                            name: drink.name,
                            category: drink.category,
                            percentage,
                            missing: totalIngredients - matchCount
                        });
                    }
                }
            });

            matches.sort((a, b) => b.percentage - a.percentage);

            if (matches.length === 0) {
                document.getElementById('drinksGrid').innerHTML = `
                    <div class="no-results">
                        <h2>üòÖ No Matches Found</h2>
                        <p>Try adding more common ingredients to your inventory!</p>
                    </div>
                `;
                document.getElementById('resultCount').textContent = 'No drinks match your ingredients';
                return;
            }

            displayedDrinks = matches.map(m => m.key);
            displayDrinksWithMatches(matches);
            document.getElementById('resultCount').textContent = 
                `Found ${matches.length} drink${matches.length !== 1 ? 's' : ''} you can make!`;
        }

        function displayDrinksWithMatches(matches) {
            const allDrinks = getAllDrinks();
            const grid = document.getElementById('drinksGrid');
            
            grid.innerHTML = matches.map(match => {
                const drink = allDrinks[match.key];
                const matchClass = match.percentage === 100 ? 'perfect' : 'partial';
                const isFavorite = favorites.includes(match.key);
                
                return `
                    <div class="drink-card">
                        <button class="favorite-btn ${isFavorite ? 'favorited' : ''}" onclick="toggleFavorite('${match.key}')">
                            ${isFavorite ? '‚ù§Ô∏è' : 'ü§ç'}
                        </button>
                        <div class="drink-header">
                            <h2 class="drink-title">${drink.name}</h2>
                            <div style="margin-top: 8px;">
                                <span class="drink-category">${drink.category}</span>
                                <span class="match-percentage ${matchClass}">${match.percentage}% Match</span>
                            </div>
                        </div>
                        <ul class="ingredients-list">
                            ${drink.ingredients.map(ing => `<li>${ing}</li>`).join('')}
                        </ul>
                        ${match.missing > 0 ? `<p style="margin-top: 15px; color: #ff6b6b; font-size: 0.9em;">Missing ${match.missing} ingredient${match.missing !== 1 ? 's' : ''}</p>` : ''}
                    </div>
                `;
            }).join('');

            updateTotalCount();
        }

        function displayDrinks(drinkKeys) {
            const allDrinks = getAllDrinks();
            const grid = document.getElementById('drinksGrid');
            
            if (drinkKeys.length === 0) {
                grid.innerHTML = `
                    <div class="no-results">
                        <h2>ü§∑‚Äç‚ôÇÔ∏è No Drinks Found</h2>
                        <p>Try a different search term or browse all drinks</p>
                    </div>
                `;
                updateTotalCount();
                return;
            }

            grid.innerHTML = drinkKeys.map(key => {
                const drink = allDrinks[key];
                const isFavorite = favorites.includes(key);
                
                return `
                    <div class="drink-card">
                        <button class="favorite-btn ${isFavorite ? 'favorited' : ''}" onclick="toggleFavorite('${key}')">
                            ${isFavorite ? '‚ù§Ô∏è' : 'ü§ç'}
                        </button>
                        <div class="drink-header">
                            <h2 class="drink-title">${drink.name}</h2>
                            <span class="drink-category">${drink.category}</span>
                        </div>
                        <ul class="ingredients-list">
                            ${drink.ingredients.map(ing => `<li>${ing}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }).join('');

            updateTotalCount();
        }

        function displayFavorites() {
            const grid = document.getElementById('favoritesGrid');
            const allDrinks = getAllDrinks();
            
            if (favorites.length === 0) {
                grid.innerHTML = `
                    <div class="no-results">
                        <h2>No Favorites Yet</h2>
                        <p>Click the heart icon on any drink to add it to your favorites!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = favorites.map(key => {
                const drink = allDrinks[key];
                if (!drink) return '';
                
                return `
                    <div class="drink-card">
                        <button class="favorite-btn favorited" onclick="toggleFavorite('${key}')">‚ù§Ô∏è</button>
                        <div class="drink-header">
                            <h2 class="drink-title">${drink.name}</h2>
                            <span class="drink-category">${drink.category}</span>
                        </div>
                        <ul class="ingredients-list">
                            ${drink.ingredients.map(ing => `<li>${ing}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }).join('');
        }

        function addToInventory() {
            const input = document.getElementById('newIngredient');
            const ingredient = input.value.trim();
            
            if (!ingredient) return;
            if (inventory.includes(ingredient)) {
                alert('This ingredient is already in your inventory!');
                return;
            }
            
            inventory.push(ingredient);
            DB.set('inventory', inventory);
            input.value = '';
            displayInventory();
            updateDataSummary();
        }

        function removeFromInventory(ingredient) {
            inventory = inventory.filter(i => i !== ingredient);
            DB.set('inventory', inventory);
            displayInventory();
            updateDataSummary();
        }

        function displayInventory() {
            const grid = document.getElementById('inventoryGrid');
            
            if (inventory.length === 0) {
                grid.innerHTML = `
                    <div style="grid-column: 1/-1; text-align: center; color: #666;">
                        <p>Your inventory is empty. Start adding ingredients!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = inventory.map(ingredient => `
                <div class="inventory-item">
                    <span>${ingredient}</span>
                    <button class="btn-accent btn-small" onclick="removeFromInventory('${ingredient.replace(/'/g, "\\'")}')">Remove</button>
                </div>
            `).join('');
        }

        function saveCustomDrink() {
            const name = document.getElementById('customName').value.trim();
            const category = document.getElementById('customCategory').value;
            const ingredientsText = document.getElementById('customIngredients').value.trim();
            
            if (!name || !ingredientsText) {
                alert('Please fill in the drink name and ingredients!');
                return;
            }
            
            const ingredients = ingredientsText.split('\n').filter(i => i.trim());
            const key = 'custom-' + name.toLowerCase().replace(/\s+/g, '-').replace(/[^a-z0-9-]/g, '');
            
            customDrinks[key] = {
                name: name,
                category: category,
                ingredients: ingredients,
                custom: true
            };
            
            DB.set('customDrinks', customDrinks);
            
            document.getElementById('customName').value = '';
            document.getElementById('customIngredients').value = '';
            
            alert('Custom drink saved!');
            displayCustomDrinks();
            createCategoryFilters();
            updateDataSummary();
        }

        function deleteCustomDrink(key) {
            if (confirm('Are you sure you want to delete this drink?')) {
                delete customDrinks[key];
                DB.set('customDrinks', customDrinks);
                displayCustomDrinks();
                createCategoryFilters();
                updateDataSummary();
            }
        }

        function displayCustomDrinks() {
            const grid = document.getElementById('customDrinksGrid');
            const customKeys = Object.keys(customDrinks);
            
            if (customKeys.length === 0) {
                grid.innerHTML = `
                    <div class="no-results">
                        <h2>No Custom Drinks Yet</h2>
                        <p>Add your own recipes above!</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = customKeys.map(key => {
                const drink = customDrinks[key];
                
                return `
                    <div class="drink-card">
                        <div class="drink-header">
                            <h2 class="drink-title">${drink.name}</h2>
                            <span class="drink-category">${drink.category}</span>
                        </div>
                        <ul class="ingredients-list">
                            ${drink.ingredients.map(ing => `<li>${ing}</li>`).join('')}
                        </ul>
                        <button class="btn-accent btn-small" style="margin-top: 15px;" onclick="deleteCustomDrink('${key}')">Delete</button>
                    </div>
                `;
            }).join('');
        }

        function exportData() {
            const data = {
                favorites: favorites,
                inventory: inventory,
                customDrinks: customDrinks,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `tiki-bar-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);
        }

        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (data.favorites) {
                        favorites = data.favorites;
                        DB.set('favorites', favorites);
                    }
                    if (data.inventory) {
                        inventory = data.inventory;
                        DB.set('inventory', inventory);
                    }
                    if (data.customDrinks) {
                        customDrinks = data.customDrinks;
                        DB.set('customDrinks', customDrinks);
                    }
                    
                    alert('Data imported successfully!');
                    updateDataSummary();
                    createCategoryFilters();
                } catch (err) {
                    alert('Error importing data. Please check the file format.');
                    console.error(err);
                }
            };
            reader.readAsText(file);
            
            event.target.value = '';
        }

        function clearAllData() {
            if (!confirm('Are you sure you want to clear ALL data? This cannot be undone!')) {
                return;
            }
            
            if (!confirm('Really sure? This will delete favorites, inventory, and custom drinks!')) {
                return;
            }
            
            favorites = [];
            inventory = [];
            customDrinks = {};
            
            DB.remove('favorites');
            DB.remove('inventory');
            DB.remove('customDrinks');
            
            updateDataSummary();
            createCategoryFilters();
            alert('All data cleared!');
        }

        function updateDataSummary() {
            document.getElementById('favCount').textContent = favorites.length;
            document.getElementById('invCount').textContent = inventory.length;
            document.getElementById('customCount').textContent = Object.keys(customDrinks).length;
        }

        function updateTotalCount() {
            const allDrinks = getAllDrinks();
            const totalDrinks = Object.keys(allDrinks).length;
            document.getElementById('totalCount').textContent = 
                `Total: ${totalDrinks} drinks in database`;
        }

        document.addEventListener('DOMContentLoaded', () => {
            init();
            
            document.getElementById('searchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') searchDrinks();
            });
            
            document.getElementById('ingredientsInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') findDrinksByIngredients();
            });
            
            document.getElementById('newIngredient').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addToInventory();
            });
        });
    </script>
</body>
</html>
